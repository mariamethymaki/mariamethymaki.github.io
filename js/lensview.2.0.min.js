/* --------------------
 Lensview Plugin v2.0
 http://joeyvo.me
 ------------------- */
;(function(a){a.lensView=function(g,e){var c=a(g),d=a("<div>"),h=a.extend({},a.lensView.defaults,e),f={},b={};b={init:function(){c.src=c.attr("src");if(e.src!==undefined){c.src=e.src}else{if(e.srcInRel){c.src=c.attr("rel")}}c.borderWidth={left:0,right:0,top:0,bottom:0};for(var i in c.borderWidth){c.borderWidth[i]=parseInt(c.css("border-"+i+"-width"),10)}c.Owidth;c.Oheight;c.Dwidth=c.width();c.Dheight=c.height();var j=new Image();j.src=c.src;j.onload=function(){c.Owidth=this.width,c.Oheight=this.height};if(c.Dwidth<1||c.Dheight<1){c.clone().load(function(){c.Dwidth=c.innerWidth()+c.borderWidth.left+c.borderWidth.right;c.Dheight=c.innerHeight()+c.borderWidth.top+c.borderWidth.bottom}).appendTo(c.parent()).hide()}d.content=(e.innerHTML!==undefined)?e.innerHTML:h.innerHTML;d.thisclass=(e.lensClass)?e.lensClass:h.lensClass;d.css(f.defaults).addClass(d.thisclass).html(d.content);if(e.caption){d.caption=a("<div>").addClass(h.namespace+"caption").text(c.attr("title")).css(f.caption);d.caption.appendTo(c.parent())}d.css({backgroundImage:"url('"+c.src+"')"});d.appendTo(a("body"));c.mouseenter(function(k){b.update(k)});c.mousemove(function(k){b.update(k)});d.mousemove(function(k){b.update(k);h.onover(c,d)});d.click(function(k){if(e.zoomOnClick){b.zoom(k)}});h.start(c,d);c.mouseX=0;c.mouseY=0;a(document).mousemove(function(k){c.mouseX=k.pageX;c.mouseY=k.pageY});d.checker=setInterval(function(){b.check()},1000)},update:function(i){c.left=c.offset().left;c.top=c.offset().top;c.stop();d.stop();d.leftmax=c.Dwidth+c.left;d.topmax=c.Dheight+c.top;d.x=i.pageX-(h.size/2);d.y=i.pageY-(h.size/2);d.css({left:d.x+"px",top:d.y+"px"});if(i.pageX>=d.leftmax||i.pageY>=d.topmax||i.pageX<=c.left||i.pageY<=c.top){b.goingOut();h.onexit(c,d)}else{h.onenter(c,d);b.goingIn();b.doMath(i)}},doMath:function(i){c.wr=c.Owidth/c.Dwidth;c.hr=c.Oheight/c.Dheight;d.bgleft=String(((i.pageX-c.left)*c.wr-h.size/2)*(-1));d.bgtop=String(((i.pageY-c.top)*c.hr-h.size/2)*(-1))},goingIn:function(){d.show();if(e.caption){d.caption.show();d.caption.x=d.x+((h.size-d.caption.outerWidth())/2);d.caption.css({left:d.caption.x+"px",top:d.y+h.size+"px"})}if(e.overlay){b.overlay(true)}d.css({backgroundPosition:d.bgleft+"px "+d.bgtop+"px"})},goingOut:function(){c.stop();d.stop();d.hide();if(e.caption){d.caption.hide()}if(e.overlay){b.overlay(false)}},overlay:function(i){c.opacity=(i)?h.overlayOpacity:1;c.animate({opacity:c.opacity},h.overlaySpeed,h.overlayEasing)},check:function(){if(c.mouseX>=d.leftmax||c.mouseY>=d.topmax||c.mouseX<=c.left||c.mouseY<=c.top){b.goingOut()}},zoom:function(i){d.stop();d.bgs=d.css("backgroundSize");c.zoomFactor=(e.zoomFactor!==undefined)?e.zoomFactor:h.zoomFactor;c.Zwidth=(d.bgs===c.Owidth+"px")?c.Owidth*c.zoomFactor:c.Owidth;if(c.Zwidth>c.Owidth){h.onzoomin(c,d)}else{h.onzoomout(c,d)}d.animate({backgroundSize:c.Zwidth})}};f={defaults:{backgroundPosition:"0px 0px",backgroundSize:"auto auto",backgroundRepeat:"no-repeat",width:h.size,height:h.size,position:"absolute",display:"none",cursor:"none"},caption:{position:"absolute",display:"none"}};b.init()};a.lensView.defaults={namespace:"Lens-",lensClass:"lensView",size:150,overlay:false,overlayClass:"",overlayOpacity:0.5,overlaySpeed:500,overlayEasing:"linear",zoomOnClick:false,zoomFactor:1.5,srcInRel:false,innerHTML:"&nbsp",caption:false,start:function(){},onenter:function(){},onover:function(){},onexit:function(){},onzoomin:function(){},onzoomout:function(){}};a.fn.lensView=function(b){b=b||{};if(typeof b==="object"){return this.each(function(){var c=a(this);if(c.data("lensView")===undefined){new a.lensView(this,b)}})}}})(jQuery);